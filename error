/var/spool/slurmd/job20562526/slurm_script: line 23: master_addr: command not found
Did not find AutoResume SDK!
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [03:38<03:38, 218.06s/it]Loading checkpoint shards: 100%|██████████| 2/2 [03:45<00:00, 94.20s/it] Loading checkpoint shards: 100%|██████████| 2/2 [03:45<00:00, 112.78s/it]
WARNING:root:You are setting tunable parameters for the model. Previous args include 'freeze_backbone' and 'tune_mm_mlp_adapter' are deprecated.
 Notice: default value of tune_xxx is False, which means you would not tune this part.
WARNING:accelerate.utils.other:Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
Using /mmfs1/home/zanqil/.cache/torch_extensions/py310_cu117 as PyTorch extensions root...
Emitting ninja build file /mmfs1/home/zanqil/.cache/torch_extensions/py310_cu117/cpu_adam/build.ninja...
Building extension module cpu_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Loading extension module cpu_adam...
WARNING:urllib3.connectionpool:Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
Traceback (most recent call last):
  File "/gscratch/sciencehub/zanqil/VILA/llava/train/train_mem.py", line 36, in <module>
    train()
  File "/gscratch/sciencehub/zanqil/VILA/llava/train/train.py", line 456, in train
    trainer.save_state()
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/transformers/trainer.py", line 1537, in train
    return inner_training_loop(
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/transformers/trainer.py", line 1772, in _inner_training_loop
    self.control = self.callback_handler.on_train_begin(args, self.state, self.control)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/transformers/trainer_callback.py", line 370, in on_train_begin
    return self.call_event("on_train_begin", args, state, control)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/transformers/trainer_callback.py", line 414, in call_event
    result = getattr(callback, event)(
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/transformers/integrations/integration_utils.py", line 767, in on_train_begin
    self.setup(args, state, model, **kwargs)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/transformers/integrations/integration_utils.py", line 740, in setup
    self._wandb.init(
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1195, in init
    wandb._sentry.reraise(e)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/analytics/sentry.py", line 155, in reraise
    raise exc.with_traceback(sys.exc_info()[2])
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1180, in init
    wi.setup(kwargs)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 189, in setup
    self._wl = wandb_setup.setup(settings=setup_settings)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_setup.py", line 325, in setup
    ret = _setup(settings=settings)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_setup.py", line 318, in _setup
    wl = _WandbSetup(settings=settings)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_setup.py", line 303, in __init__
    _WandbSetup._instance = _WandbSetup__WandbSetup(settings=settings, pid=pid)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_setup.py", line 114, in __init__
    self._setup()
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_setup.py", line 250, in _setup
    self._setup_manager()
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_setup.py", line 283, in _setup_manager
    self._manager = wandb_manager._Manager(settings=self._settings)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/wandb_manager.py", line 145, in __init__
    self._service.start()
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/service/service.py", line 253, in start
    self._launch_server()
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/service/service.py", line 247, in _launch_server
    _sentry.reraise(e)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/analytics/sentry.py", line 155, in reraise
    raise exc.with_traceback(sys.exc_info()[2])
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/service/service.py", line 245, in _launch_server
    self._wait_for_ports(fname, proc=internal_proc)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/service/service.py", line 134, in _wait_for_ports
    raise ServiceStartTimeoutError(
wandb.sdk.service.service.ServiceStartTimeoutError: Timed out waiting for wandb service to start after 30.0 seconds. Try increasing the timeout with the `_service_wait` setting.
WARNING:urllib3.connectionpool:Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
WARNING:urllib3.connectionpool:Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(FileNotFoundError(2, 'No such file or directory'))': /api/4504800232407040/envelope/
Traceback (most recent call last):
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/__main__.py", line 3, in <module>
    cli.cli(prog_name="python -m wandb")
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/cli/cli.py", line 108, in wrapper
    return func(*args, **kwargs)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/cli/cli.py", line 292, in service
    server.serve()
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/service/server.py", line 114, in serve
    self._inform_used_ports(sock_port=sock_port)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/service/server.py", line 52, in _inform_used_ports
    pf.write(self._port_fname)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/wandb/sdk/service/port_file.py", line 21, in write
    f = tempfile.NamedTemporaryFile(prefix=bname, dir=dname, mode="w", delete=False)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/tempfile.py", line 575, in NamedTemporaryFile
    file = _io.open(dir, mode, buffering=buffering,
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/tempfile.py", line 572, in opener
    fd, name = _mkstemp_inner(dir, prefix, suffix, flags, output_type)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/tempfile.py", line 256, in _mkstemp_inner
    fd = _os.open(file, flags, 0o600)
FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpoc77a906/port-27233.txtj0j3ap74'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 27233) of binary: /gscratch/sciencehub/zanqil/.conda/envs/vila/bin/python
Traceback (most recent call last):
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/gscratch/sciencehub/zanqil/.conda/envs/vila/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
llava/train/train_mem.py FAILED
------------------------------------------------------------
Failures:
  <NO_OTHER_FAILURES>
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-09-05_13:42:46
  host      : g3071.hyak.local
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 27233)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
INFO:    Terminating squashfuse_ll after timeout
INFO:    Timeouts can be caused by a running background process
